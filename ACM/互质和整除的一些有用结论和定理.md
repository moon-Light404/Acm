### **互质和整除的一些有用结论和定理**

1、d 整除 a 记作： d|a

如果 d|a  且 d|b，那么 d | (ax + by)



2、如果p是素数，且 p | ab，则 p | a 或者 p | b (或者同时都可整除)

证：假设 p 不整除 a, 考虑 gcd(p, a) = 1，则有 px + ay = 1 = gcd(p,a)

两边同乘b， 得 $bpx + aby = b$ ， $bpx = b(1-ay)$， 因为左边 p 整除 bpx，所以右边等价于 p 整除 b。



3、1和任意的一个自然数都是互质关系



4、任意两个质数构成互质关系



5、一个数是质数，另一个数只要不是前者的倍数，两者构成互质关系



6、p 是大于1的整数，则 p 和 p-1 构成互质关系



7、p 是大于1的奇数，则 p 和 p-2构成互质关系



8、素数 p 与 [1, p - 1]的任意整数均互质， 并且 $(p-1)!$ 与 p 互质





### 欧几里得算法

（GCD)递归： $gcd(a,b) = gcd(b, a modb)$

```c++
gcd(a,b):
return b == 0?a:gcd(b,1 % b)
```





### 扩展欧几里得算法

可以用来求解一类线性方程组的解，求解过程与最大公约数有密切关系。

$ax + by = gcd(a,b)$ 此线性方程必然有整数解

如果 $ax +by =m$有解，那么 m一定是 $gcd(a,b)$的若干倍。

当欧几里得递归到边界时，b == 0，a = gcd(a,b)，这时方程有一个解： $a*1 + b * 0 =gcd(a,b)$，x = 1，y = 0，

<u>这是递归到最后一步的边界，a、b每次递归的值都已经变化了，要求出原始的解，就要回到最开始的模样。</u>

$ax + by = gcd(a,b)$

bx1 + (a%b)*y1 = gcd(b,a%b) = gcd(a,b) .....，gcd的值一直是相等的

a % b = a - (a / b) * b，代入

$bx1 + a * y1 - (a/b) * b* y1$ 

$= a * y1 + b1 * (x1 - a/b * y1) = ax + by$  

发现，$x = y1$，$y = (x_1 - a /b * y_1)$   (x,y是初始的，x1，y1是一步一步gcd变换的)

这样就得到了相邻两个状态的x和y的转化关系，就可以在求gcd的同时对 x 和 y 进行求值

```c++
int exgcd(int a,int b,int &x,int &y)
{
    if (b == 0)
    {
        x=1,y=0;
        return;
    }
    int r = exgcd(b, a%b, x, y)
    int t = y; // (把最里一层的y记录下来)
    y = x - (a / b)*y;
    x = t;
    return r; // 最大公因数
}
```

### 求逆元

$(ax) mod b = 1$, 即 x 是 a 的乘法逆元

则有 $ax = by' + 1$   $ax + by = 1$，一直递归然后回溯就可以求出x的值



### 算术基本定理

**（算术基本定理）**：每个整数 $n \geq2$ 可唯一分解成素数的乘积：

$n = p_1^{e_1}P_2^{e_2}...p_r^{e_r}$

- 如果 n 是合数，则在小于等于 $\sqrt{n}$的数中必定有一个数a整除合数n(所以判断素数时，只要要小于等于$\sqrt{n}$)

该结论基于算术基本定理：合数nn必定可以唯一分解多个素数的乘积，这里假设pp是它的素因子中最小的一个，则nn必定可以写成n=p×mn=p×m的形式，这里的mm是其余大于等于pp的素因子的乘积，显然m⩾pm⩾p,因此n=p×m⩾p×p=p2





### 同余与模算术

$2 \equiv 5(mod3)$，表示模3时2与5同余

- 如果已知$a_1 \equiv b_1(mod m)$ 且 $a_2 \equiv b_2(mod m)$

那么有

$a_2 \pm a_1 \equiv b_2 \pm b_1 (mod m)$和$a_1b_2 \equiv b_1b_2(mod m)$

如果 $a^k \equiv b (mod m)$，那么 $((a^k))^j \equiv b^j(mod m)$

当b = 1时，$((a^k))^j \equiv 1 (mod m)$



- 但是 $ac \equiv bc (mod m)$   不一定会有$a \equiv b (mod m)$

只有 c 和 m(gcd(c ,m ) == 1) 互质时，才能从同余式两边消去 c

==$ax \equiv c (mod m)$==

- 同余方程定理：

设$ g =gcd(a,m)$，则

1）如果 g 不整除 c ( c / g != 0)，那么同余方程没有解

2）如果 g | c，那么恰好有 g 个解，当 a 和 m 互质时，有一个解



a，m互质时，a和m的公因数为1，即 g = 1，同余方程

$ax \equiv 1 (mod m)$，a 和 x 互为模反元素











